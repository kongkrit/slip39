<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>SLIP-39 Generator and Recovery (Offline)</title>
  <link rel="icon" href="icons/favicon.svg" type="image/svg+xml">
  <link rel="stylesheet" href="css/styles.css">

</head>
<body>
  <header>
    <h1>SLIP-39 Generator and Recovery (Offline)</h1>
    <div class="sub">Runs entirely offline in your browser. Generates <b>SLIP-39</b> <i>M-of-N</i> <b>Master Secret</b> shares (10 bits/word) and recovers secrets from <i>M</i>&nbsp;mnemonics. An <i>optional</i> <b>passphrase</b> can be set during creation and must be re-entered for recovery.</div>
    <div id="integrity-pill" class="pill danger" style="display:none">Integrity compromised â€“ reload the page</div>
  </header>
  <main class="grid">

    <!-- Card1 : Create -->

    <section id="create" class="card">
    <details id="create-details" open>
      <summary>
        <div id="create-card-summary" class="summary-text">
          <h2 class="summary-text">Create Shares<span id="create-pill" class="pill accent"></span></h2>
          <p class="note-text">Create a new secret or split an existing one into mnemonic shares.<br>
          See the <a href="#combine">Combine shares</a> section below to combine existing shares.</p>
        </div>
      </summary>

      <h3>Secret</h3>

	  <div id="secret-creation-mode">
  	    <p>Create master secret with:</p>
        <div class="btn-group" role="group" aria-label="create secret mode" id="secret-mode-buttons">
          <input type="radio" class="btn-check" name="secret-mode" id="secret-hex" value="hex" checked>
          <label class="btn" for="secret-hex">Random</label>
          <input type="radio" class="btn-check" name="secret-mode" id="secret-ascii" value="txt">
          <label class="btn" for="secret-ascii">Text</label>
        </div>
	  </div>

      <div id="random-buttons">
	    <p></p>
        <p>Securely generate a random master secret with strength of:</p>
        <div class="row">
          <button id="strength-128" class="generate" data-strength="128">128 bits</button>
          <button id="strength-160" class="generate" data-strength="160">160 bits</button>
          <button id="strength-192" class="generate" data-strength="192">192 bits</button>
          <button id="strength-224" class="generate" data-strength="224">224 bits</button>
          <button id="strength-256" class="generate" data-strength="256">256 bits</button>
        </div>
	  </div>

	  <div id="secret-text-input">
	    <p></p>
	    <label id="master-secret-txt-label" for="master-secret-txt"></label>
		<div class="input-with-btn">
	      <textarea id="master-secret-txt" rows="2" placeholder="enter text here..."></textarea>
		  <button onclick="copyToClipboard('master-secret-txt')" id="master-secret-txt-copy" type="button" aria-label="copy master secret text"></button>
		</div>
	  </div>

      <label id="master-secret-hex-label" for="master-secret-hex"></label>
      <div class="input-with-btn">
        <textarea id="master-secret-hex" rows="2"></textarea>
        <button onclick="copyToClipboard('master-secret-hex')" id="master-secret-hex-copy" type="button" aria-label="copy master secret hex"></button>
      </div>
      <p class="err" id="master-secret-hex-error"></p>
      <label id="master-secret-b58-label" for="master-secret-b58"></label>
      <div class="input-with-btn">
	    <textarea id="master-secret-b58" rows="2"></textarea>
        <button onclick="copyToClipboard('master-secret-b58')" id="master-secret-b58-copy" type="button" aria-label="copy master secret base 58"></button>
      </div>
      <p class="err" id="master-secret-b58-error"></p>

      <label for="passphrase">Passphrase (optional)</label>
      <div class="input-with-btn">
        <input id="passphrase" type="password" placeholder="eg MySecretPassphrase" autocomplete="off"
               autocapitalize="off" spellcheck="false" inputmode="text">
        <button id="passphrase-toggle" type="button" aria-label="Show passphrase"></button>
      </div>

      <h3>Groups and Members</h3>

      <div class="shares-threshold-row">
          <div class="field">
              <div class="number-control">
                  <label for="total-shares">Total Shares:&nbsp;&nbsp;</label>
                  <button type="button" class="decrement" data-target="total-shares"></button>
                  <input id="total-shares" class="share-parameters-display" type="number" value="3" readonly>
                  <button type="button" class="increment" data-target="total-shares"></button>
              </div>
              <p id="total-shares-error" class="err"></p>
              <p class="note">The number of shares to generate.</p>
          </div>
          <div class="field">
              <div class="number-control">
                  <label for="threshold">Threshold:&nbsp;&nbsp;</label>
                  <button type="button" class="decrement" data-target="threshold"></button>
                  <input id="threshold" class="share-parameters-display" type="number" value="2" readonly>
                  <button type="button" class="increment" data-target="threshold"></button>
              </div>
              <p id="threshold-error" class="err"></p>
              <p class="note">The number of shares needed to reconstruct the master secret.</p>
          </div>
      </div>

        <div id="create-card-summary" class="summary-text">
          <h3 class="summary-text">Created Shares</h3>
          <p class="note-text">Shares created by parameters from <i>Create</i> section</p>
        </div>

      <div id="mnemonic-block">
          <label for="new-shares">Mnemonics</label>
          <textarea id="new-shares" rows="10" readonly placeholder="Mnemonic Shares will be shown here"></textarea>
      </div>
      <p></p>
      <div id="base58-block">
          <label for="new-shares-base58">Base-58</label>
          <textarea id="new-shares-base58" rows="10" readonly placeholder="Base-58 Shares will be shown here"></textarea>
      </div>
    </details>
    </section>

    <!-- Card 2: Combine -->

    <section id="combine" class="card">
    <details id="combine-details" open>
      <summary>
        <div id="combine-card-summary" class="summary-text">
          <h2 class="summary-text">Combine Shares<span id="combine-pill" class="pill accent"></span></h2>
          <p class="note-text">Input created shares and optional passphrase to recover the master secret</p>
        </div>
      </summary>

      <div id="combine-modes">
        <p></p>
        <p>Recover a master secret from a set of:</p>
        <div class="btn-group" role="group" aria-label="Combine mode">
          <input type="radio" class="btn-check" name="combine-mode" id="mode-mnemonics" value="mnemonics" checked>
          <label class="btn" for="mode-mnemonics">Mnemonics</label>

          <input type="radio" class="btn-check" name="combine-mode" id="mode-base58" value="base58">
          <label class="btn" for="mode-base58">Base-58</label>
        </div>
      </div>

      <label id="decode-mode" for="existing-shares"></label>
      <textarea id="existing-shares" rows="10"></textarea>
      <p class="err" id="reconstructed-error"></p>

      <div id="decoded-block">
          <label id="convert-to" for="decoded-mnemonics"></label>
          <textarea id="decoded-mnemonics" readonly rows="10"></textarea>
      </div>

      <label for="decrypter">Passphrase</label>
      <div class="input-with-btn">
        <input id="decrypter" type="password" autocomplete="off" autocapitalize="off" spellcheck="false" inputmode="text">
        <button id="decrypter-toggle" type="button" aria-label="Show passphrase"></button>
      </div>

        <div id="result-card-summary" class="summary-text">
          <h3 class="summary-text">Recovered Master Secret</h2>
          <p class="note-text">Master Secret recovered from shares and optional passphrase</p>
        </div>

      <div id="reconstructed-txt-output" hidden>
        <label id="reconstructed-txt-label" for="reconstructed-txt"></label>
        <div class="input-with-btn">
          <textarea id="reconstructed-txt" rows="2" placeholder="(shown if master secret can be converted to text)" readonly></textarea>
          <button onclick="copyToClipboard('reconstructed-txt')" id="reconstructed-txt-copy" type="button" aria-label="copy reconstructed text"></button>
        </div>
      </div>

      <label id="reconstructed-hex-label" for="reconstructed-hex"></label>
      <div class="input-with-btn">
        <textarea id="reconstructed-hex" rows="2" readonly></textarea>
        <button onclick="copyToClipboard('reconstructed-hex')" id="reconstructed-hex-copy" type="button" aria-label="copy reconstructed hex"></button>
      </div>
      <label id="reconstructed-b58-label" for="reconstructed-b58"></label>
      <div class="input-with-btn">
        <textarea id="reconstructed-b58" rows="2" readonly></textarea>
        <button onclick="copyToClipboard('reconstructed-b58')" id="reconstructed-b58-copy" type="button" aria-label="copy reconstructed base 58"></button>
      </div>
    </details>
    </section>
  </main>

  <script src="icons/icons-svg.js"></script>
  <script src="js/slip39-libs.js"></script>
  <script src="js/wordlist.js"></script>
  <script src="js/converter.js"></script>
  <script src="js/index.js"></script>
  <script src="js/integrity-check.js"></script>
</body>
</html>
