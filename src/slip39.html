<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>SLIP-39 Generator and Recovery (Offline)</title>
  <link rel="icon" href="icons/favicon.svg" type="image/svg+xml">
  <link rel="stylesheet" href="css/styles.css">

</head>
<body>
  <header>
    <h1>SLIP-39 Generator and Recovery (Offline)</h1>
    <div class="sub">Runs entirely offline in your browser. Generates <b>SLIP-39</b> <i>M-of-N</i> <b>Master Secret</b> shares (10 bits/word) and recovers secrets from <i>M</i>&nbsp;mnemonics. An <i>optional</i> <b>passphrase</b> can be set during creation and must be re-entered for recovery.</div>
    <div id="integrity-pill" class="pill danger" style="display:none">Integrity compromised â€“ reload the page</div>
  </header>
  <main class="grid">

    <!-- Card1 : Create -->
	
    <section id="create" class="card">
	<details open>
	  <summary>
	    <div id="create-card-summary" class="summary-text">
          <h2 class="summary-text">Create Shares</h2>
          <p class="note-text">Create a new secret or split an existing one into mnemonic shares.<br>
		  See the <a href="#combine">Combine shares</a> section below to combine existing shares.</p>
		</div>
	  </summary>

      <h3>Secret</h3>
      <p>Securely generate random master secret with strength of:</p>
      <div class="row">
        <button id="strength-128" class="generate" data-strength="128">128 bits</button>
        <button id="strength-160" class="generate" data-strength="160">160 bits</button>
        <button id="strength-192" class="generate" data-strength="192">192 bits</button>
        <button id="strength-224" class="generate" data-strength="224">224 bits</button>
        <button id="strength-256" class="generate" data-strength="256">256 bits</button>
      </div>

      <label id="master-secret-hex-text" for="master-secret-hex"></label>
      <input id="master-secret-hex" type="text" placeholder="hex string eg 0123456789abcdef0123456789ABCDEF">
      <p class="err" id="master-secret-hex-error"></p>
      <label for="master-secret-b58">Master Secret (Base58)</label>
      <input id="master-secret-b58" type="text" placeholder="base58 string [1-9A-HJ-NP-Za-km-z]">
      <p class="err" id="master-secret-b58-error"></p>

      <label for="passphrase">Passphrase (optional)</label>
      <div class="input-with-btn">
        <input id="passphrase" type="password" placeholder="eg MySecretPassphrase" autocomplete="off"
		       autocapitalize="off" spellcheck="false" inputmode="text">
        <button id="passphrase-toggle" type="button" aria-label="Show passphrase">
          <img alt="">
        </button>
      </div>

      <h3>Groups and Members</h3>

      <div class="shares-threshold-row">
          <div class="field">
              <div class="number-control">
                  <label for="total-shares">Total Shares:&nbsp</label>
                  <input id="total-shares" type="number" value="3" readonly>
                  <button type="button" class="decrement" data-target="total-shares">-</button>
                  <button type="button" class="increment" data-target="total-shares">+</button>
              </div>
              <p id="total-shares-error" class="err"></p>
              <p class="note">The number of shares to generate.</p>
          </div>
          <div class="field">
              <div class="number-control">
                  <label for="threshold">Threshold:&nbsp</label>
                  <input id="threshold" type="number" value="2" readonly>
                  <button type="button" class="decrement" data-target="threshold">-</button>
                  <button type="button" class="increment" data-target="threshold">+</button>
              </div>
              <p id="threshold-error" class="err"></p>
              <p class="note">The number of shares needed to reconstruct the master secret.</p>
          </div>
      </div>
	</details>
	</section>

    <!-- Card 2: Created Shares -->
	
    <section id="create" class="card">
	<details open>
	  <summary>
	    <div id="create-card-summary" class="summary-text">
          <h2 class="summary-text">Created Shares</h2>
		  <p class="note-text">Shares created by parameters from <i>Create</i> section</p>
		</div>
	  </summary>

      <div id="mnemonic-block">
          <label for="new-shares">Mnemonics</label>
          <textarea id="new-shares" rows="10" readonly placeholder="Mnemonic Shares will be shown here"></textarea>
      </div>
      <p></p>
      <div id="base58-block">
          <label for="new-shares-base58">Base-58</label>
          <textarea id="new-shares-base58" rows="10" readonly placeholder="Base-58 Shares will be shown here"></textarea>
      </div>
    </details>
	</section>
	
	<!-- Card 3: Combine -->

    <section id="combine" class="card">
	<details open>
	  <summary>
	    <div id="combine-card-summary" class="summary-text">
          <h2 class="summary-text">Combine Shares</h2>
		  <p class="note-text">Input created shares and optional passphrase to recover the master secret</p>
	    </div>
	  </summary>
	  
      <div id="combine-modes">
	    <p></p>
	    <p>Recover a master secret from a set of:</p>
        <div class="btn-group" role="group" aria-label="Combine mode">
          <input type="radio" class="btn-check" name="combine-mode" id="mode-mnemonics" value="mnemonics" checked>
          <label class="btn" for="mode-mnemonics">Mnemonics</label>

          <input type="radio" class="btn-check" name="combine-mode" id="mode-base58" value="base58">
          <label class="btn" for="mode-base58">Base-58</label>
        </div>
      </div>

      <label id="decode-mode" for="existing-shares"></label>
      <textarea id="existing-shares" rows="10"></textarea>
      <p class="err" id="reconstructed-error"></p>

      <div id="decoded-block">
          <label id="convert-to" for="decoded-mnemonics"></label>
          <textarea id="decoded-mnemonics" readonly rows="10"></textarea>
      </div>

      <label for="decrypter">Passphrase</label>
      <div class="input-with-btn">
        <input id="decrypter" type="password" autocomplete="off" autocapitalize="off" spellcheck="false" inputmode="text">
        <button id="decrypter-toggle" type="button" aria-label="Show passphrase">
          <img alt="">
        </button>
      </div>
	</details>
    </section>
	
	<!-- Card 4: Result -->

    <section id="result" class="card">
	<details open>
	  <summary>
	    <div id="result-card-summary" class="summary-text">
          <h2 class="summary-text">Recovered Master Secret</h2>
		  <p class="note-text">Master Secret recovered from shares and optional passphrase</p>
	    </div>
	  </summary>
	  
      <label id="reconstructed-hex-text" for="reconstructed-hex"></label>
      <input id="reconstructed-hex" type="text" readonly>
      <label for="reconstructed-b58">Master Secret (Base58)</label>
      <input id="reconstructed-b58" type="text" readonly>
	</details>
    </section>
  </main>

  <script src="icons/eye-open.js"></script>
  <script src="icons/eye-closed.js"></script>
  <script src="js/slip39-libs.js"></script>
  <script src="js/wordlist.js"></script>
  <script src="js/converter.js"></script>
  <script src="js/index.js"></script>
  <script src="js/integrity-check.js"></script>
</body>
</html>
